#:kivy 1.8.0
#:import Factory kivy.factory.Factory

#:set white (255, 255, 255, 1)  # white
#:set color_button_pressed (255, 255, 255, 1)  # white
#:set color_font   (0, 0, 0, 1)  # black

<TagSpinnerOption@SpinnerOption>:
    background_color: white if self.state == 'down' else white
    color: color_font
    valign: "middle"
    halign: "center"
    text_size: self.width-(self.width*.1), self.height

<StationListingItem>:
    size_hint_y: None
    size_hint_x: None
    background_color: (0, 0, 0, 0)
    text_size: 190, 225
    valign: "middle"
    halign: "left"
    canvas.after:
        Rectangle:
            size:self.width, 1
            pos: self.pos

<LoadDialog>:
    BoxLayout:
        size: root.size
        pos: root.pos
        orientation: "vertical"
        FileChooserListView:
            id: filechooser

        BoxLayout:
            size_hint_y: None
            height: 30
            Button:
                text: "Cancel"
                on_release: root.cancel()

            Button:
                text: "Load"
                on_release: root.load(filechooser.path, filechooser.selection)

<PlaylistDetails>:
    cover_image: cover_image
    station_text_details: station_text_details
    download_dir: download_dir
    canvas.after:
        Rectangle:
            size:1, root.height
            pos: root.right, 0
        Rectangle:
            size:1, root.height
            pos: root.x, 0
    Image:
        id: cover_image
        source: "assets/image-loading.gif"
        size_hint_x: None
        size_hint_y: None
        valign: "middle"
    Label:
        id: station_text_details
        size_hint_y: None
        size_hint_x: None
        height: 225
        width: root.width - 20
        text_size: root.width - 20, 225
        markup: True
        valign: "middle"
        halign: "left"
    TextInput:
        id: download_dir
        background_color: white
        size_hint_y: None
        size_hint_x: None
        size: root.width - 20, 35
        hint_text: "save directory..."
        on_focus: root.show_load()
    Button:
        text: "Start download"
        size_hint_y: None
        size_hint_x: None
        size: root.width - 20, 30
        on_release: root.download()

<PlaylistDownloader>:
    Label:
        text: "Download"

<DownloaderWrapper>:
    id: main_screen
    playlist_search_panel: playlist_search_panel
    playlist_details: playlist_details
    playlist_downloader: playlist_downloader
    canvas.before:
        Rectangle:
            size: self.size
            source: 'assets/background-gradient.png'
    BoxLayout:
        PlaylistSearchPanel:
            station_list: station_list
            genre_list: genre_list
            id: playlist_search_panel
            orientation: "vertical"
            size_hint: None, None
            height:root.height
            width: root.width *.33
            GenreSpinner:
                id: genre_list
                size_hint_y: None
                height: root.height * .05
                background_color: white if self.state == 'normal' else white
                color: color_font
                option_cls: Factory.get("TagSpinnerOption")
                on_text: playlist_search_panel.genre_picked(args[1])
                text: "Choose a genre"
            StationList:
                id: station_list
                height: root.height * .95
                do_scroll_x: False
        PlaylistDetails:
            id: playlist_details
            orientation: "vertical"
            size_hint: None, None
            height:root.height
            width: root.width * .33
            cols: 1
            size_hint: (None, None)
            padding: (10, 20)
            spacing: (20, 20)

        PlaylistDownloader:
            id: playlist_downloader
            orientation: "vertical"
            size_hint: None, None
            height:root.height
            width: root.width *.33
        
